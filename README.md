# 学生时代模组兼容分析工具

一个用于分析学生时代游戏模组兼容性的Web应用，能够检测模组中的重复ID，避免游戏冲突。
## b站链接 [图文](https://www.bilibili.com/opus/1162123484982149144?spm_id_from=333.1387.0.0)
## github链接[仓库](https://github.com/lincexu/StudentAgeLinceModController)

### 本文件由ai总结生成，请注意！

## 版本信息

**当前版本：0.4.4**

## 核心功能

- 📁 支持同时上传多个模组文件夹
- 🔍 检测重复的事件ID、物品ID、书籍ID和行动ID
- 📊 数据可视化，直观展示统计信息
- 🎨 支持浅色/深色主题切换

- 📱 支持响应式设计，适配各种设备
- 📋 支持表格横竖列布局切换，支持热更新
- ⚙️ 丰富的设置选项，个性化定制

- 🗃️ ID类型实时数据库
  - 基于idTypelib.json中定义的所有ID类型创建
  - 支持从lib/Cfg和baseGame目录加载默认数据
  - 支持用户临时上传的数据
  - 记录每项ID类型的所有ID以及对应name属性
  - 支持根据ID查询Name和根据Name查询ID
  - 修复了id=0时数据无法获取的问题

## 新增功能 (v0.4.4)

- 修复了行动事件详情切换页面后状态异常的问题
- 新增大量判断、条件的规则（基于官方1.31更新的指南）
- 新增输入页码切换功能，支持快速跳转至指定页面
- 修复了在页面切换后，某些文本替换失效的问题

## 环境要求（强烈建议）

- **Python 3**：用于启动本地HTTP服务器
  - 下载链接：[Python官方网站](https://www.python.org/downloads/)
  - 安装完成后，可在命令行中运行 `python --version` 或 `python3 --version` 验证安装

## 快速开始

### 启动方式

#### Windows系统（推荐）
1. 双击运行 `start_server.bat` 脚本
2. 浏览器将自动打开 `http://localhost:8000`

#### Linux/macOS系统（推荐）
1. 打开终端，进入项目目录
2. 运行命令：`chmod +x start_server.sh && ./start_server.sh`
3. 浏览器将自动打开 `http://localhost:8000`

#### 手动启动

使用Python 3：
```bash
python -m http.server 8000
```

然后在浏览器中访问 `http://localhost:8000`

## 使用教程

### 1. 准备模组文件夹

确保您的模组文件夹结构符合以下格式：

```
模组文件夹/
└── Cfgs/
    └── zh-cn/
        ├── EvtCfg.json     # 事件配置文件
        ├── ItemCfg.json    # 物品配置文件
        ├── BookCfg.json    # 书籍配置文件
        └── ActionCfg.json  # 行动配置文件
```

### 2. 上传模组文件夹

#### 方式一：点击上传
1. 点击页面中央的上传区域
2. 在文件选择对话框中选择一个或多个模组文件夹
3. 点击「打开」按钮

#### 方式二：拖拽上传
1. 直接拖拽模组文件夹到上传区域
2. 等待文件上传完成

### 3. 开始分析

1. 确认已选择需要分析的模组文件夹
2. 点击「开始分析」按钮
3. 等待分析完成，查看进度条和统计信息

### 4. 查看分析结果

#### 重复ID检测
- 查看所有重复的事件ID、物品ID、书籍ID和行动ID
- 每个重复ID显示所属的模组名称和文件路径

#### 分析摘要
- 查看分析的模组数量、事件数量、物品数量等统计信息
- 显示各类型ID的使用情况
- 数据可视化图表，直观展示统计信息

#### 模组详情
- 查看每个模组的详细信息
- 支持展开/折叠查看详细数据
- 支持表格横竖列布局切换

### 5. 导出报告

1. 点击工具栏的导出报告按钮（💾）
2. 在弹出的对话框中选择导出格式（Markdown或JSON）
3. 等待报告生成完成
4. 报告将自动下载为对应的文件格式

### 6. 主题切换

- 点击工具栏的主题切换按钮（🌞/🌙）
- 切换为浅色模式或深色模式

### 7. 表格布局切换

1. 点击工具栏的设置按钮（⚙️）
2. 在设置面板中选择「详情表格布局」
3. 选择「竖列式布局」或「横列式布局」
4. 布局将自动更新，无需刷新页面

## 更新日志

### v0.4.4 (2026-02-01)
- 🗃️ ID数据库字段映射优化
  - 新增dataKey属性支持，实现灵活的字段映射
  - 数据库录入时不再局限于硬编码的name字段
  - 支持根据idTypelib.json中的dataKey属性指定要录入的字段
  - 例如：sexType类型使用desc字段作为name属性值
  - 提高了数据库的灵活性和可扩展性

### v0.4.3(2026-02-01)
- 新增人物特质的检测

### v0.4.2 (2026-01-31)
- 📂 DLC初阳自动添加：新增自动添加DLC初阳文件夹到待检测列表的功能
- 📋 虚拟滚动分页本地化：为虚拟滚动机制添加了分页本地化设置
  - 在主页面设置中添加了分页配置选项，供用户修改
- 🔍 搜索功能增强：修复了搜索栏不能搜索未显示页面内容的问题
- 🔧 修复了BaseGame部分类别id解析失败的问题
- 📕 优化了提示框效果


### v0.4.1 (2026-01-30)
- ⚙️ 配置管理优化
  - 修改了config.js中的loadConfig方法，改变了配置加载的优先级顺序
  - 现在会先合并默认配置和文件配置，确保文件配置中的所有项都被加载
  - 然后合并用户配置，用户配置会覆盖文件配置中的非应用信息项
  - 最后确保应用信息和开发者密码始终从文件配置中读取

- 📝 数据处理优化
  - 修改了idDatabase.js中的processData方法，添加了对name字段为数组的处理
  - 当name字段是数组时，会取数组的第一个元素作为nameValue
  - 确保包含HTML标签的名称能够正确显示

- 🔍 表格搜索功能增强
  - 修改了renderer.js中的performSearch函数，更新了竖列式布局的搜索逻辑
  - 现在会搜索整个卡片的所有内容，而不仅仅是id和name
  - 提高了搜索的灵活性和准确性

- 🛠️ 代码优化
  - 修复了configManager重复声明的问题
  - 改进了错误处理机制，提高了系统的稳定性
  - 优化了配置验证逻辑，确保所有配置项都被正确验证

### v0.4.0 (2026-01-29)
- 🗃️ ID类型实时数据库
  - 创建了js/core/idDatabase.js文件，实现完整的数据库功能
  - 基于idTypelib.json中allType定义的所有ID类型创建数据库
  - 支持从lib/Cfg和baseGame目录加载默认数据
  - 支持用户临时上传的数据
  - 记录每项ID类型的所有ID以及对应name属性
  - 支持根据ID查询Name和根据Name查询ID
  - 修复了id=0时数据无法获取的问题
  - 添加了test-database.html文件，提供完整的数据库测试功能
  - 添加了详细的日志和错误处理机制
  - 实现了灵活的查询系统，支持多种查询方式

- 🔧 表格渲染优化
  - 严格遵循idTypeKeys.json中的定义排列key
  - 直接从idTypelib.json中获取keyList，避免硬编码
  - 修复了类型映射问题，确保所有类型都能正确映射
  - 统一了类型id变量的命名，基于idTypelib中的定义
  - 对于idTypeKeys.json中定义但实际数据中不存在的key，显示为"-"

- 🎨 进度条优化
  - 实现了流畅的炫酷动态视觉效果
  - 改进了配色方案，确保色彩搭配协调
  - 添加了霓虹灯辉光效果，使进度显示更加醒目
  - 为不同状态（加载中、成功、错误）设计了专属的辉光效果
  - 优化了暗夜模式下的视觉效果

- 📝 Rules规则处理
  - 支持*Rules类型的文本替换，能够处理多个规则数组
  - 支持包含小数和负数的规则数组
  - 根据规则文件生成友好的文本描述
  - 实现了规则文件的预加载和缓存机制，提高性能
  - 修复了同步XMLHttpRequest的弃用警告

- 🛠️ 代码优化
  - 修改了config.js，添加了加载idTypelib.json的功能
  - 修改了renderer.js，使其更加灵活和可维护
  - 添加了js/core/utils.js文件，提供工具函数
  - 添加了lib/idTypelib.json文件，定义类型配置

### v0.3.0 (2026-01-27)
- 🔍 为模组详情页面内各ID类型的详情列表实现高级检索功能
  - ✨ 支持模糊匹配ID和名称进行搜索
  - ⚡ 实时响应用户输入，无需额外点击搜索按钮
  - 🚀 实现搜索防抖机制，优化搜索性能
  - 🎨 支持键盘操作（Enter键触发搜索、Esc键清除搜索内容）
- ✨ 新增游戏内容解析
  - 支持解析官方游戏内容（baseGame文件夹）
  - 可以配置选择是否在分析时包含官方游戏内容
- 优化导出系统
  - 优化Markdown格式
  - 优化JSON格式
  - 优化导出文件结构，包含所有分析结果


### v0.2.0 (2026-01-25)
- ✨ 表格支持横竖列布局切换功能，支持热更新
- 🎨 优化了表格样式，添加了适当的边框
- 📊 修复了图标重复问题
- 🔤 增大了标题字体，提高了可读性
- 📝 完善了README文档
- 🚀 优化了代码结构，提高了性能
- 🎯 移除了冗余的分析详情模块，简化了界面
- 📈 增强了数据可视化功能
- 📦 解决了Chart.js CDN加载问题，使用本地库

### v0.1.0 (2026-01-21)
- 🎉 初始版本发布
- 📁 支持多个模组文件夹上传
- 🔍 检测重复的事件ID、物品ID、书籍ID和行动ID
- 📊 生成详细的分析报告
- 🎨 支持浅色/深色主题切换


## 许可证

MIT License

## 作者

Lince
